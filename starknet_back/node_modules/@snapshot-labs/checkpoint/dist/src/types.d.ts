import { Pool as PgPool } from 'pg';
import { AsyncMySqlPool } from './mysql';
import { LogLevel } from './utils/logger';
import type { RPC } from 'starknet';
import type Checkpoint from './checkpoint';
import type { BaseProvider } from './providers';
export type Block = RPC.GetBlockWithTxs;
export type Transaction = RPC.Transaction;
export type PendingTransaction = RPC.PendingTransactions[number];
export type Event = RPC.GetEventsResponse['events'][number];
export type FullBlock = Block & {
    block_number: number;
};
export type DeployTransaction = Transaction & {
    contract_address: string;
};
export type EventsMap = {
    [key: string]: Event[];
};
export type ParsedEvent = Record<string, any>;
export interface CheckpointOptions {
    resetOnConfigChange?: boolean;
    logLevel?: LogLevel;
    prettifyLogs?: boolean;
    fetchInterval?: number;
    dbConnection?: string;
    abis?: Record<string, any>;
    NetworkProvider?: typeof BaseProvider;
}
export interface ContractEventConfig {
    name: string;
    fn: string;
}
export interface ContractSourceConfig {
    contract: string;
    abi?: string;
    start: number;
    deploy_fn?: string;
    events: ContractEventConfig[];
}
export type ContractTemplate = {
    abi?: string;
    events: ContractEventConfig[];
};
export interface CheckpointConfig {
    network_node_url: string;
    optimistic_indexing?: boolean;
    decimal_types?: {
        [key: string]: {
            p: number;
            d: number;
        };
    };
    start?: number;
    tx_fn?: string;
    global_events?: ContractEventConfig[];
    sources?: ContractSourceConfig[];
    templates?: {
        [key: string]: ContractTemplate;
    };
}
/**
 * Callback function invoked by checkpoint when a contract event
 * is encountered. A writer function should use the `mysql`
 * object to write to the database entities based on the require logic.
 *
 * For example, if a graphql Entity is defined in the schema:
 *
 * ```graphql
 * type Vote {
 *  id: ID!
 *  voter: String!
 * }
 * ```
 *
 * Then you can insert into the entity into the database like:
 * ```typescript
 * await args.mysql.queryAsync('INSERT INTO votes VALUES(?, ?);', ['voteId', 'voters-address']);
 *
 * // or using pg
 * await args.pg.query('INSERT INTO votes VALUES($1, $2);', ['voteId', 'voters-address']);
 * ```
 *
 * Note, Graphql Entity names are lowercased with an 's' suffix when
 * interacting with them in the databas.
 *e
 */
export type CheckpointWriter = (args: {
    tx: Transaction;
    block: FullBlock | null;
    blockNumber: number;
    event?: ParsedEvent;
    rawEvent?: Event;
    eventIndex?: number;
    source?: ContractSourceConfig;
    mysql: AsyncMySqlPool;
    pg: PgPool;
    instance: Checkpoint;
}) => Promise<void>;
/**
 * Object map of events to CheckpointWriters.
 *
 * The CheckpointWriter function will be invoked when an
 * event matching a key is found.
 *
 */
export interface CheckpointWriters {
    [event: string]: CheckpointWriter;
}
export declare function isFullBlock(block: Block): block is FullBlock;
export declare function isDeployTransaction(tx: Transaction | PendingTransaction): tx is DeployTransaction;
